#define UNIX_BUILD

#include <ros/ros.h> 
#include "mscl/mscl.h" 
#include "mscl/Types.h" 
#include "mscl/Communication/Connection.h" 
#include "mscl/MicroStrain/Inertial/InertialNode.h" 
#include "mscl/Exceptions.h" 
#include "mscl/MicroStrain/MIP/MipTypes.h"

int main(int argc, char** argv) {
	ros::init(argc, argv, "hello_world_node");

	ros::start();

	try {
		ROS_INFO_STREAM("making connection...");
		mscl::Connection connection = mscl::Connection::Serial("/dev/ttyACM0");
		mscl::InertialNode node(connection);
		if (node.ping()) {
			ROS_INFO_STREAM("connected!");
		}

		
		//imu_pub_ = node.advertise<sensor_msgs::Imu>("imu/data", 100);
		//imu_pub_.publish(imu_msg_);

	}

	catch(mscl::Error& e) {
		ROS_FATAL(e.what());
	}

//	ros::shutdown();

	return 0;
}
